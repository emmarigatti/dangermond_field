scale_y_continuous(
name = "Water potential",
sec.axis = sec_axis(~ . / scale_factor, name = "Soil moisture")
) +
scale_color_viridis_d(name = "Tree Number") +
theme_minimal() +
theme(legend.position = "right")
boxplot(Water.pot~soil_moisture,data=sf_combined_1, main="idk man",
xlab="soil mositure", ylab="water potential")
boxplot(Water.potential~soil_moisture,data=sf_combined_1, main="idk man",
xlab="soil mositure", ylab="water potential")
head(sf_combined_1)
ggplot(sf_combined_1, aes(x = factor(soil_moisture),
y = Water.potential,
fill = factor(Tree.Number))) +
geom_boxplot() +
labs(
x = "Soil moisture",
y = "Water potential",
fill = "Tree Number",
title = "Water potential by soil moisture and tree"
) +
theme_minimal()
ggplot(sf_combined_1, aes(x = factor(soil_moisture),
y = Water.potential,
fill = factor(Tree.Number))) +
geom_boxplot() +
labs(
x = "Soil moisture",
y = "Water potential",
fill = "Tree Number",
title = "Water potential vs soil moisture",
subtitle = "Date: January 31, 2025"
) +
theme_minimal()
ggplot(sf_combined_1, aes(x = factor(soil_moisture),
y = Water.potential,
fill = factor(Tree.Number))) +
geom_boxplot() +
labs(
x = "Soil moisture",
y = "Water potential",
fill = "Tree Number",
title = "Water potential vs soil moisture",
subtitle = "January 31, 2025"
) +
theme_minimal()
ggplot(sf_combined_1, aes(x = factor(soil_moisture),
y = Water.potential,
fill = factor(Tree.Number))) +
geom_boxplot() +
labs(
x = "Soil moisture (%)",
y = "Water potential (MPa)",
fill = "Tree Number",
title = "Water potential vs soil moisture",
subtitle = "January 31, 2025"
) +
theme_minimal()
# Water pot data
data1 <- read.csv("/Users/emmarigatti/Desktop/GitHub/soil_moisture_pd/Field Data 10312024 - Pressure Bomb.csv")
View(data1)
class(data1$Time)
data1[Time] <- lapply(data1[Time], as.numeric)
data1$Time <- lapply(data1$Time, as.numeric)
# Water pot data
data1 <- read.csv("/Users/emmarigatti/Desktop/GitHub/soil_moisture_pd/Field Data 10312024 - Pressure Bomb.csv")
data1$Time <- as.numeric(data1$Time)
View(data1)
# Water pot data
data1 <- read.csv("/Users/emmarigatti/Desktop/GitHub/soil_moisture_pd/Field Data 10312024 - Pressure Bomb.csv")
View(data1)
# Water pot data
data1 <- read.csv("/Users/emmarigatti/Desktop/GitHub/soil_moisture_pd/Field Data 10312024 - Pressure Bomb.csv")
data1$datetime <- as.POSIXct(
paste("2024/10/31", data1$Time),
format = "%Y/%m/%d %H:%M",
tz = "UTC"
)
View(data1)
data1 <- data1[,-2]
# For October
data1 <- data1 %>%
filter(datetime <= "2045/10/31 08:00:00")
View(data1)
# Water pot data
data1 <- read.csv("/Users/emmarigatti/Desktop/GitHub/soil_moisture_pd/Field Data 10312024 - Pressure Bomb.csv")
data1$datetime <- as.POSIXct(
paste("2024/10/31", data1$Time),
format = "%Y/%m/%d %H:%M",
tz = "UTC"
)
data1 <- data1[,-2]
# For October
data1 <- data1 %>%
filter(datetime <= "2045/10/31 08:00:00", tz = "UTC")
# For October
data1 <- data1 %>%
filter(datetime <= as.POSIXct("2045-10-31 08:00:00", tz = "UTC"))
View(data1)
class(data1$datetime)
head(data1)
# For October
data1 <- data1 %>%
filter(datetime <= as.POSIXct("2024-10-31 08:00:00", tz = "UTC"))
View(data1)
# Water pot data
data1 <- read.csv("/Users/emmarigatti/Desktop/GitHub/soil_moisture_pd/Field Data 10312024 - Pressure Bomb.csv")
data1$datetime <- as.POSIXct(
paste("2024/10/31", data1$Time),
format = "%Y/%m/%d %H:%M",
tz = "UTC"
)
data1 <- data1[,-2]
# For October
data1 <- data1 %>%
filter(datetime <= as.POSIXct("2024/10/31 08:00:00", tz = "UTC"))
nf_mid <- read.csv("/Users/emmarigatti/Desktop/GitHub/soil_moisture_pd/nf_mid.csv")
sf_bottom <- read.csv("/Users/emmarigatti/Desktop/GitHub/soil_moisture_pd/sf_bottom.csv")
sf_top <- read.csv("/Users/emmarigatti/Desktop/GitHub/soil_moisture_pd/sf_top.csv")
power_box <- read.csv("/Users/emmarigatti/Desktop/GitHub/soil_moisture_pd/power_box.csv")
soil_list <- list(nf_mid, sf_bottom, sf_top, power_box)
names(soil_list) <- c("nf_mid", "sf_bottom", "sf_top", "power_box")
for (i in seq_along(soil_list)) {
data <- soil_list[[i]]
data <- data[,-c(14:20)]
colnames(data)[1:13] <- c("datetime", paste0("Moisture_", 1:6), paste0("Temp_", 1:6))
data$datetime <- as.POSIXct(data$datetime, format = "%Y/%m/%d %H:%M:%S", tz = "UTC")
start_date <- as.POSIXct("2024/10/31 05:00:00", tz = "UTC")
end_date   <- as.POSIXct("2024/10/31 08:00:00", tz = "UTC")
data <- data %>%
filter(datetime >= start_date & datetime <= end_date)
soil_list[[i]] <- data
}
list2env(soil_list, envir = .GlobalEnv)
nf_mid_pot <- data1 %>%
filter(Location == "North facing, mid slope")
nf_top_pot <- data1 %>%
filter(Location == "North facing, top of slope")
sf_bottom_pot <- data1 %>%
filter(Location == "South facing, bottom of slope")
sf_top_pot <- data1 %>%
filter(Location == "South facing, top of slope")
# Change this for each location
soil_times  <- sf_bottom$datetime
pot_times <- sf_bottom_pot$datetime
nearest_idx <- vapply(
pot_times,
function(t) which.min(abs(as.numeric(soil_times - t))),
integer(1)
)
sf_bottom_pot$soil_moisture <- sf_bottom[nearest_idx, 2]
soil_times  <- sf_top$datetime
pot_times <- sf_top_pot$datetime
nearest_idx <- vapply(
pot_times,
function(t) which.min(abs(as.numeric(soil_times - t))),
integer(1)
)
sf_top_pot$soil_moisture <- sf_top[nearest_idx, 2]
sf_combined_2 <- rbind(sf_bottom_pot, sf_top_pot)
View(sf_combined_2)
# Change this for each location
soil_times  <- sf_bottom$datetime
pot_times <- sf_bottom_pot$datetime
sf_bottom_pot <- data1 %>%
filter(Location == "South facing, bottom of slope")
ggplot(sf_combined_2, aes(x = factor(soil_moisture),
y = Water.potential,
fill = factor(Tree.Number))) +
geom_boxplot() +
labs(
x = "Soil moisture (%)",
y = "Water potential (MPa)",
fill = "Tree Number",
title = "Water potential vs soil moisture",
subtitle = "October 31, 2024"
) +
theme_minimal()
sf_combined_2 <- rbind(sf_bottom_pot, sf_top_pot)
sf_combined_2 <- sf_combined_1[,-c(3:5)]
ggplot(sf_combined_2, aes(x = factor(soil_moisture),
y = Water.potential,
fill = factor(Tree.Number))) +
geom_boxplot() +
labs(
x = "Soil moisture (%)",
y = "Water potential (MPa)",
fill = "Tree Number",
title = "Water potential vs soil moisture",
subtitle = "October 31, 2024"
) +
theme_minimal()
sf_combined_2 <- rbind(sf_bottom_pot, sf_top_pot)
View(sf_combined_2)
ggplot(sf_combined_2, aes(x = factor(soil_moisture),
y = Water.Potential..mPa.,
fill = factor(Tree.Number))) +
geom_boxplot() +
labs(
x = "Soil moisture (%)",
y = "Water potential (MPa)",
fill = "Tree Number",
title = "Water potential vs soil moisture",
subtitle = "October 31, 2024"
) +
theme_minimal()
setwd("~/Desktop/GitHub/dangermond_field/pressure_bomb")
# Read in data
psi_data <- read.csv("20250812_psi.csv")
View(psi_data)
head(psi_data)
psi_data <- psi_data %>%
mutate(Group = case_when(
N.S == "SF" & Location == "Top"    ~ 1,
N.S == "SF" & Location == "Bottom" ~ 2,
N.S == "NF" & Location == "Top"    ~ 3,
N.S == "NF" & Location == "Mid"    ~ 4,
TRUE ~ NA_real_
))
library(tidyr)
library(dplyr)
library(ggplot2)
library(lubridate)
library(zoo)
psi_data <- psi_data %>%
mutate(Group = case_when(
N.S == "SF" & Location == "Top"    ~ 1,
N.S == "SF" & Location == "Bottom" ~ 2,
N.S == "NF" & Location == "Top"    ~ 3,
N.S == "NF" & Location == "Mid"    ~ 4,
TRUE ~ NA_real_
))
View(psi_data)
head(psi_data)
ggplot(psi_data, aes(x = factor(Group), y = Water.pot, fill = Time)) +
geom_boxplot(position = position_dodge(width = 0.8)) +
labs(
x = "Group",
y = "Water Potential (MPa)",
fill = "Time"
) +
theme_minimal()
# Read in data
psi_data <- read.csv("20250812_psi.csv")
psi_data <- psi_data %>%
mutate(Group = case_when(
N.S == "SF" & Location == "Top"    ~ "SF Top",
N.S == "SF" & Location == "Bottom" ~ "SF Bottom",
N.S == "NF" & Location == "Top"    ~ "NF Top",
N.S == "NF" & Location == "Mid"    ~ "NF Mid",
TRUE ~ NA_real_
))
psi_data <- psi_data %>%
mutate(Group = case_when(
N.S == "SF" & Location == "Top"    ~ "SF Top",
N.S == "SF" & Location == "Bottom" ~ "SF Bottom",
N.S == "NF" & Location == "Top"    ~ "NF Top",
N.S == "NF" & Location == "Mid"    ~ "NF Mid",
TRUE ~ NA_character_
))
ggplot(psi_data, aes(x = factor(Group), y = Water.pot, fill = Time)) +
geom_boxplot(position = position_dodge(width = 0.8)) +
labs(
x = "Group",
y = "Water Potential (MPa)",
fill = "Time"
) +
theme_minimal()
# Curious about the summary
summary <- psi_data %>%
group_by(Group, Time) %>%
summarise(
mean_psi = mean(Water.pot, na.rm = TRUE),
sd_psi   = sd(Water.pot, na.rm = TRUE),
se_psi   = sd_psi / sqrt(n()),
n        = n()
)
summary
ggplot(psi_data, aes(x = factor(Group), y = Water.pot, fill = Time)) +
geom_boxplot(position = position_dodge(width = 0.8)) +
labs(
x = "Group",
y = "Water Potential (MPa)",
fill = "Time",
title = "Pre-dawn and Midday Water Potential",
subtitle = "By location across a hillslope gradient"
) +
theme_minimal()
counts <- psi_data %>%
group_by(Group, Time) %>%
summarise(n = n(), .groups = "drop")
ggplot(psi_data, aes(x = factor(Group), y = Water.pot, fill = Time)) +
geom_boxplot(position = position_dodge(width = 0.8)) +
geom_text(
data = counts,
aes(x = factor(Group), y = max(psi_data$Water.pot) + 0.2, label = n, group = Time),
position = position_dodge(width = 0.8),
inherit.aes = FALSE
) +
labs(
x = "Group",
y = "Water Potential (MPa)",
fill = "Time"
) +
theme_minimal()
psi_data
psi_data_leaf <- psi_data %>%
select(which(Organ == "Leaf"))
psi_data_leaf <- psi_data %>%
filter(Organ == "Leaf")
psi_data_stem <- psi_data %>%
filter(Organ == "Stem")
ggplot(psi_data_leaf, aes(x = factor(Group), y = Water.pot, fill = Time)) +
geom_boxplot(position = position_dodge(width = 0.8)) +
labs(
x = "Group",
y = "Water Potential (MPa)",
fill = "Time",
title = "Pre-dawn and Midday Leaf Water Potential",
subtitle = "By location across a hillslope gradient"
) +
theme_minimal()
ggplot(psi_data_stem, aes(x = factor(Group), y = Water.pot, fill = Time)) +
geom_boxplot(position = position_dodge(width = 0.8)) +
labs(
x = "Group",
y = "Water Potential (MPa)",
fill = "Time",
title = "Pre-dawn and Midday Stem Water Potential",
subtitle = "By location across a hillslope gradient"
) +
theme_minimal()
ggplot(psi_data, aes(x = factor(Group), y = Water.pot, fill = Organ)) +
geom_boxplot(position = position_dodge(width = 0.8)) +
labs(
x = "Group",
y = "Water Potential (MPa)",
fill = "Time",
title = "Pre-dawn and Midday Stem Water Potential",
subtitle = "By location across a hillslope gradient"
) +
theme_minimal()
ggplot(
psi_data %>% filter(Time == "md"),
aes(x = factor(Group), y = Water.pot, fill = Organ)
) +
geom_boxplot(position = position_dodge(width = 0.8)) +
labs(
x = "Group",
y = "Water Potential (MPa)",
fill = "Organ",
title = "Midday Stem and Leaf Water Potential",
subtitle = "By location across a hillslope gradient"
) +
theme_minimal()
ggplot(
psi_data %>% filter(Time == "pd"),
aes(x = factor(Group), y = Water.pot, fill = Organ)
) +
geom_boxplot(position = position_dodge(width = 0.8)) +
labs(
x = "Group",
y = "Water Potential (MPa)",
fill = "Organ",
title = "Predawn Stem and Leaf Water Potential",
subtitle = "By location across a hillslope gradient"
) +
theme_minimal()
ggplot(
psi_data %>% filter(Time == "pd"),
aes(x = factor(Group), y = Water.pot, fill = Organ)
) +
geom_boxplot(position = position_dodge(width = 0.8)) +
scale_fill_manual(
values = c("Leaf" = "#1b9e77", "Stem" = "#d95f02")
) +
labs(
x = "Group",
y = "Water Potential (MPa)",
fill = "Organ",
title = "Predawn Stem and Leaf Water Potential",
subtitle = "By location across a hillslope gradient"
) +
theme_minimal()
ggplot(
psi_data %>% filter(Time == "md"),
aes(x = factor(Group), y = Water.pot, fill = Organ)
) +
geom_boxplot(position = position_dodge(width = 0.8)) +
scale_fill_manual(
values = c("Leaf" = "#1b9e77", "Stem" = "#d95f02")
) +
labs(
x = "Group",
y = "Water Potential (MPa)",
fill = "Organ",
title = "Midday Stem and Leaf Water Potential",
subtitle = "By location across a hillslope gradient"
) +
theme_minimal()
delta_psi_leaf <- psi_data_leaf %>%
pivot_wider(names_from = Time, values_from = Water.pot) %>%
mutate(delta_psi = md - pd)
View(delta_psi_leaf)
View(delta_psi_leaf)
ggplot(delta_psi_leaf, aes(x = factor(Group), y = delta_psi, fill = Organ)) +
geom_boxplot(position = position_dodge(width = 0.8)) +
labs(
x = "Group",
y = "Water Potential (MPa)",
fill = "Time",
title = "expression(Delta*psi)Stem Water Potential",
subtitle = "By location across a hillslope gradient"
) +
theme_minimal()
ggplot(delta_psi_leaf, aes(x = factor(Group), y = delta_psi, fill = Organ)) +
geom_boxplot(position = position_dodge(width = 0.8)) +
labs(
x = "Group",
y = expression(Delta*psi),
fill = "Time",
title = expression(Delta*psi~" Stem Water Potential"),,
subtitle = "By location across a hillslope gradient"
) +
theme_minimal()
delta_psi <- psi_data %>%
pivot_wider(names_from = Time, values_from = Water.pot) %>%
mutate(delta_psi = md - pd)
ggplot(delta_psi, aes(x = factor(Group), y = delta_psi, fill = Organ)) +
geom_boxplot(position = position_dodge(width = 0.8)) +
labs(
x = "Group",
y = expression(Delta*psi),
fill = "Time",
title = expression(Delta*psi~"Water Potential"),,
subtitle = "By location across a hillslope gradient"
) +
theme_minimal()
ggplot(delta_psi, aes(x = factor(Group), y = delta_psi, fill = Organ)) +
geom_boxplot(position = position_dodge(width = 0.8)) +
scale_fill_manual(
values = c("Leaf" = "#1b9e77", "Stem" = "#d95f02")
) +
labs(
x = "Group",
y = expression(Delta*psi),
fill = "Organ",
title = expression(Delta*psi~"Water Potential"),,
subtitle = "By location across a hillslope gradient"
) +
theme_minimal()
ggplot(delta_psi_leaf, aes(x = pd, y = md, color = Group)) +
geom_point() +
geom_smooth(method = "lm", se = FALSE) +
labs(x = expression(psi[pd]~"(MPa)"),
y = expression(psi[md]~"(MPa)"))
ggplot(delta_psi_leaf, aes(x = pd, y = delta_psi, color = Group)) +
geom_point() +
geom_smooth(method = "lm", se = FALSE)
ggplot(delta_psi_leaf, aes(x = pd, y = delta_psi, color = Group)) +
geom_point() +
geom_smooth(method = "lm", se = FALSE)
ggplot(delta_psi_leaf, aes(x = pd, y = md, color = Group)) +
geom_point() +
geom_smooth(method = "lm", se = FALSE)
ggplot(delta_psi_leaf, aes(x = pd, y = delta_psi, color = Group)) +
geom_point() +
geom_smooth(method = "lm", se = FALSE)
pd_data <- psi_data %>% filter(Time == "pd") %>%
select(Tree, Group, Organ, Water.pot) %>%
pivot_wider(names_from = Organ, values_from = Water.pot)
ggplot(pd_data, aes(x = Stem, y = Leaf, color = Group)) +
geom_point(size = 3) +
geom_smooth(method = "lm", se = FALSE) +
labs(
x = expression(psi[stem]~"(MPa)"),
y = expression(psi[leaf]~"(MPa)"),
title = "Predawn Stem–Leaf Coordination"
)
psi_offsets <- psi_data %>%
pivot_wider(names_from = Organ, values_from = Water.pot) %>%
mutate(offset = Leaf - Stem)
ggplot(psi_offsets, aes(x = Group, y = offset, fill = Time)) +
geom_boxplot(position = position_dodge(width = 0.8)) +
labs(
x = "Group",
y = expression(psi[leaf] - psi[stem]~"(MPa)"),
title = "Leaf–Stem Water Potential Offsets"
)
ggplot(psi_data %>% filter(Organ %in% c("Leaf", "Stem")),
aes(x = Stem, y = Leaf, color = Group)) +
geom_point() +
geom_smooth(method = "lm", se = FALSE) +
facet_wrap(~ Time)
head(psi_data)
psi_wide <- psi_data %>%
pivot_wider(
names_from = Organ,
values_from = Water.pot
)
# Now plot Stem vs Leaf
ggplot(psi_wide, aes(x = Stem, y = Leaf, color = Group)) +
geom_point() +
geom_smooth(method = "lm", se = FALSE) +
facet_wrap(~ Time) +
labs(
x = expression(psi[stem]~"(MPa)"),
y = expression(psi[leaf]~"(MPa)"),
title = "Stem–Leaf Coordination Across Hill Slope Gradient"
) +
theme_minimal()
