library(tidyr)
library(dplyr)
library(ggplot2)
library(lubridate)
library(zoo)
# Set working directory
setwd("~/Desktop/GitHub/dangermond_field/pressure_bomb")
# Read in data
psi_data <- read.csv("20250812_psi.csv")
psi_data <- psi_data %>%
mutate(Group = case_when(
N.S == "SF" & Location == "Top"    ~ "SF Top",
N.S == "SF" & Location == "Bottom" ~ "SF Bottom",
N.S == "NF" & Location == "Top"    ~ "NF Top",
N.S == "NF" & Location == "Mid"    ~ "NF Mid",
TRUE ~ NA_character_
))
summary <- psi_data %>%
group_by(Group, Time) %>%
summarise(
mean_psi = mean(Water.pot, na.rm = TRUE),
sd_psi   = sd(Water.pot, na.rm = TRUE),
se_psi   = sd_psi / sqrt(n()),
n        = n()
)
psi_wide <- psi_data %>%
mutate(Time = factor(Time, levels = c("pd", "md"))) %>%
pivot_wider(
names_from = Organ,
values_from = Water.pot
)
ggplot(psi_wide, aes(x = Stem, y = Leaf, color = Group)) +
geom_point() +
geom_smooth(method = "lm", se = FALSE) +
facet_wrap(~ Time) +
geom_abline(intercept = 0, slope = 1, linetype = "dashed", color = "black") +
labs(
x = expression(psi[stem]~"(MPa)"),
y = expression(psi[leaf]~"(MPa)"),
title = "Stem–Leaf Coordination Across Hillslope Gradient"
) +
theme_minimal()
psi_wide <- psi_data %>%
mutate(Organ = factor(Organ, levels = c("Leaf", "Stem"))) %>%
pivot_wider(
names_from = Time,
values_from = Water.pot
)
ggplot(psi_wide, aes(x = md, y = pd, color = Group)) +
geom_point() +
geom_smooth(method = "lm", se = FALSE) +
facet_wrap(~ Time) +
geom_abline(intercept = 0, slope = 1, linetype = "dashed", color = "black") +
labs(
x = expression(psi[stem]~"(MPa)"),
y = expression(psi[leaf]~"(MPa)"),
title = "Stem–Leaf Coordination Across Hillslope Gradient"
) +
theme_minimal()
head(psi_data)
ggplot(psi_wide, aes(x = md, y = pd, color = Group)) +
geom_point() +
geom_smooth(method = "lm", se = FALSE) +
facet_wrap(~ Organ) +
geom_abline(intercept = 0, slope = 1, linetype = "dashed", color = "black") +
labs(
x = expression(psi[stem]~"(MPa)"),
y = expression(psi[leaf]~"(MPa)"),
title = "Stem–Leaf Coordination Across Hillslope Gradient"
) +
theme_minimal()
ggplot(psi_wide, aes(x = md, y = pd, color = Group)) +
geom_point() +
geom_smooth(method = "lm", se = FALSE) +
facet_wrap(~ Organ) +
geom_abline(intercept = 0, slope = 1, linetype = "dashed", color = "black") +
labs(
x = "Pre-dawn"),
ggplot(psi_wide, aes(x = md, y = pd, color = Group)) +
geom_point() +
geom_smooth(method = "lm", se = FALSE) +
facet_wrap(~ Organ) +
geom_abline(intercept = 0, slope = 1, linetype = "dashed", color = "black") +
labs(
x = "Pre-dawn",
y = "Midday",
title = "Stem–Leaf Coordination Across Hillslope Gradient"
) +
theme_minimal()
